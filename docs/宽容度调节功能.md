# 赛道宽容度调节功能

## 功能概述

在赛道录制界面增加了宽容度调节按钮，用户可以快速选择适合当前场景的匹配精度。

## 位置布局

宽容度按钮位于赛道录制页面的统计信息区域，在距离和点数显示的右侧。

```
[距离: 0.00km] [点数: 0] [Road (50m)]
[开始录制] [暂停] [设置起终点]
```

## 宽容度选项

当点击宽容度按钮时，会弹出选择对话框，提供4种预设选项：

### 1. Precision Track (25m)
- **适用场景**: 高精度赛道，如F1赛道、专业卡丁车场
- **特点**: 对路线偏差要求极严格
- **显示**: `Precision (25m)`

### 2. Street Circuit (40m) - 默认选择
- **适用场景**: 城市街道赛道，临时封闭道路
- **特点**: 平衡精度与容错性
- **显示**: `Street (40m)`

### 3. General Road (50m)
- **适用场景**: 一般公路、乡村道路
- **特点**: 适中的容错范围
- **显示**: `Road (50m)`

### 4. Highway (80m)
- **适用场景**: 高速公路、宽阔道路
- **特点**: 最大容错范围，适合高速场景
- **显示**: `Highway (80m)`

## 使用方法

1. **进入录制页面**: 在主界面切换到"Track"标签页
2. **选择宽容度**: 点击右上角的宽容度按钮（如`Road (50m)`）
3. **选择选项**: 在弹出的对话框中选择适合的宽容度
4. **确认选择**: 选择后按钮文字会自动更新
5. **开始录制**: 使用新的宽容度设置录制赛道

## 技术实现

### UI 组件
- **按钮**: `btnTolerance` 在 `fragment_track.xml` 中定义
- **对话框**: 使用 `AlertDialog` 的单选列表样式
- **布局**: 水平排列的统计信息容器

### 数据管理
- **ViewModel**: `TrackViewModel.getCurrentTolerance()` 和 `setTolerance()`
- **状态管理**: 使用 `MutableStateFlow` 管理当前宽容度
- **默认值**: 街道赛道模式 (40m)

### 实际应用
- **TrackMatcher**: 根据设置的宽容度进行轨迹相似度计算
- **实时更新**: 选择新宽容度后立即生效
- **状态保持**: 在录制会话期间保持选择的宽容度

## 最佳实践建议

### 场景选择指南

**Precision Track (25m)**:
- ✅ 专业赛车场
- ✅ 室内卡丁车场
- ❌ 街道或公路

**Street Circuit (40m)**:
- ✅ 城市街道赛道
- ✅ 临时封闭路段
- ✅ 大多数日常使用

**General Road (50m)**:
- ✅ 乡村公路
- ✅ 山路
- ✅ 一般户外场地

**Highway (80m)**:
- ✅ 高速公路测试
- ✅ 宽阔直道
- ✅ GPS信号不稳定区域

### 注意事项

1. **录制前选择**: 建议在开始录制前选择合适的宽容度
2. **场景匹配**: 根据实际驾驶环境选择对应的宽容度
3. **精度平衡**: 过严格可能导致匹配失败，过宽松可能降低精度
4. **一致性**: 同一类型赛道建议使用相同的宽容度设置

## 后续功能扩展

- **自定义宽容度**: 允许用户输入自定义数值
- **智能推荐**: 根据GPS精度自动推荐宽容度
- **历史记录**: 记住每个赛道的首选宽容度设置
- **批量应用**: 对已录制赛道批量更新宽容度设置